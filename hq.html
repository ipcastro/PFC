<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HQ - Física Divertida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/auth.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            "50": "#f5f3ff",
                            "100": "#ede9fe",
                            "200": "#ddd6fe",
                            "300": "#c4b5fd",
                            "400": "#a78bfa",
                            "500": "#8b5cf6",
                            "600": "#7c3aed",
                            "700": "#6d28d9",
                            "800": "#5b21b6",
                            "900": "#4c1d95",
                            "950": "#2e1065"
                        },
                        secondary: {
                            "50": "#eff6ff",
                            "100": "#dbeafe",
                            "200": "#bfdbfe",
                            "300": "#93c5fd",
                            "400": "#60a5fa",
                            "500": "#3b82f6",
                            "600": "#2563eb",
                            "700": "#1d4ed8",
                            "800": "#1e40af",
                            "900": "#1e3a8a",
                            "950": "#172554"
                        },
                        accent: {
                            "50": "#fdf2f8",
                            "100": "#fce7f3",
                            "200": "#fbcfe8",
                            "300": "#f9a8d4",
                            "400": "#f472b6",
                            "500": "#ec4899",
                            "600": "#db2777",
                            "700": "#be185d",
                            "800": "#9d174d",
                            "900": "#831843",
                            "950": "#500724"
                        }
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-gray-50 dark:bg-gray-900">
    <nav class="fixed w-full z-20 top-0 start-0 bg-white border-gray-200 dark:bg-gray-900">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
            <div class="flex items-center space-x-3">
                <a href="index.html" class="flex items-center space-x-3">
                    <img src="img/logopng.png" class="h-12" alt="Física Divertida Logo">
                    <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Física Divertida</span>
                </a>
            </div>
            <div class="flex items-center space-x-3 md:order-3">
                <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <section class="pt-32 bg-gradient-to-b from-primary-50 via-secondary-50 to-accent-50 dark:from-gray-900 dark:to-gray-800">
        <div class="py-8 px-4 mx-auto max-w-screen-xl text-center lg:py-16">
            <h1 class="mb-4 text-4xl font-extrabold tracking-tight leading-none text-gray-900 md:text-5xl lg:text-6xl dark:text-white">
                História em Quadrinhos</h1>
            <p class="mb-8 text-lg font-normal text-gray-500 lg:text-xl sm:px-16 lg:px-48 dark:text-gray-400">
                Aprenda física de forma divertida com nossa HQ educacional! Acompanhe as aventuras de Amélia e Newton enquanto exploram os conceitos fundamentais da cinemática.</p>
        </div>
    </section>

    <section class="bg-gradient-to-b from-accent-50 via-primary-50 to-secondary-50 dark:from-gray-800 dark:to-gray-900">
        <div class="py-8 px-4 mx-auto max-w-5xl lg:py-12">
            <div class="bg-white border border-gray-200 rounded-lg shadow-lg dark:bg-gray-700 dark:border-gray-600 p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                    <div class="order-1 md:order-1 self-start">
                        <img src="img/capa hq.jpg" alt="Capa da HQ" class="rounded-lg shadow-lg w-full h-auto object-contain">
                    </div>
                    <div class="order-2 md:order-2 self-start">
                        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Física em Quadrinhos: Volume 1</h2>
                        <p class="text-gray-600 dark:text-gray-300 mb-6">
                            Neste primeiro volume, Amélia conhece Newton e juntos exploram os conceitos fundamentais da cinemática. 
                            Através de situações do dia a dia e experimentos divertidos, eles descobrem.
                        </p>
                        <div class="flex flex-wrap gap-3">
                            <a href="#" onclick="handleAuthenticatedAction('ler-online')" class="inline-flex items-center px-5 py-3 text-base font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-900">
                                Ler Online
                                <svg class="w-5 h-5 ml-2 -mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                </svg>
                            </a>
                            <a href="#" onclick="handleAuthenticatedAction('download-pdf')" data-pdf-file="Planeta da Aurora_ vol.1.pdf" class="inline-flex items-center px-5 py-3 text-base font-medium text-center text-white bg-green-600 rounded-lg hover:bg-green-700 focus:ring-4 focus:ring-green-300 dark:focus:ring-green-900">
                                Baixar PDF
                                <svg class="w-5 h-5 ml-2 -mr-1" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd"></path>
                                </svg>
                            </a>
                            <a href="#" onclick="return handleAuthenticatedRequest(() => window.location.href = 'chatbot pfc/index.html')" class="inline-flex items-center px-5 py-3 text-base font-medium text-center text-white rounded-lg bg-green-600 hover:bg-green-700 focus:ring-4 focus:ring-green-300 dark:focus:ring-green-900">
                                Fazer Quiz
                                <svg class="w-5 h-5 ml-2 -mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="bg-gradient-to-b from-secondary-50 via-accent-50 to-primary-50 dark:from-gray-900 dark:to-gray-800 py-16">
        <div class="max-w-screen-xl mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-12 dark:text-white">Integrantes do Projeto</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white border border-gray-200 rounded-lg shadow-md dark:bg-gray-700 dark:border-gray-600 p-6 text-center">
                    <img src="img/mariani.jpg" alt="Mariani Denig" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Mariani Denig</h3>
                    <p class="text-gray-600 dark:text-gray-300">Desenvolvimento Web e Design</p>
                </div>
                <div class="bg-white border border-gray-200 rounded-lg shadow-md dark:bg-gray-700 dark:border-gray-600 p-6 text-center">
                    <img src="img/isabela.jpg" alt="Isabela Castro" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Isabela Castro</h3>
                    <p class="text-gray-600 dark:text-gray-300">Conteúdo e Pesquisa</p>
                </div>
                <div class="bg-white border border-gray-200 rounded-lg shadow-md dark:bg-gray-700 dark:border-gray-600 p-6 text-center">
                    <img src="img/criadora1.jpg" alt="Maria Eduarda Sagava" class="w-32 h-32 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Maria Eduarda Sagava</h3>
                    <p class="text-gray-600 dark:text-gray-300">Arte e Ilustração</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-gradient-to-b from-primary-50 via-secondary-50 to-accent-50 dark:from-gray-800 dark:to-gray-900">
        <div class="max-w-screen-xl mx-auto px-4 py-8 md:py-16">
            <div class="text-center text-gray-600 dark:text-gray-400">
                <p>&copy; 2024 Física Divertida. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Modal de Login Inline -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-sm p-6">
            <h3 class="text-lg font-semibold mb-4 text-gray-900 dark:text-white">Fazer login</h3>
            <div class="space-y-4">
                <div>
                    <label for="login-email" class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Email</label>
                    <input id="login-email" type="email" class="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="seu@email.com">
                </div>
                <div>
                    <label for="login-senha" class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Senha</label>
                    <input id="login-senha" type="password" class="w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="******">
                </div>
                <div class="flex gap-2 justify-end">
                    <button id="login-cancel" class="px-4 py-2 rounded border dark:border-gray-600 text-gray-700 dark:text-gray-200">Cancelar</button>
                    <button id="login-submit" class="px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white">Entrar</button>
                </div>
                <p id="login-error" class="text-sm text-red-600 hidden">E-mail ou senha inválidos.</p>
            </div>
        </div>
    </div>

    <script>
        // Gerenciamento do tema (igual ao index)
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
        const themeToggleBtn = document.getElementById('theme-toggle');

        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            themeToggleLightIcon?.classList.remove('hidden');
        } else {
            document.documentElement.classList.remove('dark');
            themeToggleDarkIcon?.classList.remove('hidden');
        }

        themeToggleBtn?.addEventListener('click', function() {
            themeToggleDarkIcon?.classList.toggle('hidden');
            themeToggleLightIcon?.classList.toggle('hidden');

            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });

        // Exigir autenticação para downloads marcados
        const API_BASE = 'https://pfc-nrpx.onrender.com';
        let pendingDownloadFile = null;

        function openLoginModal() {
            document.getElementById('login-error').classList.add('hidden');
            document.getElementById('login-email').value = '';
            document.getElementById('login-senha').value = '';
            const modal = document.getElementById('login-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            setTimeout(() => document.getElementById('login-email').focus(), 0);
        }

        function closeLoginModal() {
            const modal = document.getElementById('login-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        let pendingAction = null;

        function handleAuthenticatedAction(action) {
            if (!isAuthenticated()) {
                pendingAction = action;
                openLoginModal();
                return;
            }
            executeAction(action);
        }

        function executeAction(action) {
            const token = localStorage.getItem('token');
            if (action === 'download-pdf') {
                const pdfFile = document.querySelector('[data-pdf-file]').getAttribute('data-pdf-file');
                const url = `${API_BASE}/api/download/pdf?file=${encodeURIComponent(pdfFile)}&token=${encodeURIComponent(token)}`;
                window.open(url, '_blank');
            } else if (action === 'ler-online') {
                window.location.href = `paginas-hq/pagina1.html?token=${encodeURIComponent(token)}`;
            }
        }

        async function performLoginAndDownload() {
            const email = document.getElementById('login-email').value.trim();
            const senha = document.getElementById('login-senha').value;
            if (!email || !senha) return;
            try {
                const res = await fetch(`${API_BASE}/api/users/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, senha })
                });
                const result = await res.json().catch(() => ({}));
                if (res.ok && result.token) {
                    localStorage.setItem('token', result.token);
                    closeLoginModal();
                    if (pendingAction) {
                        executeAction(pendingAction);
                        pendingAction = null;
                    }
                } else {
                    document.getElementById('login-error').classList.remove('hidden');
                }
            } catch (_) {
                document.getElementById('login-error').classList.remove('hidden');
            }
        }

        document.getElementById('login-cancel').addEventListener('click', closeLoginModal);
        document.getElementById('login-submit').addEventListener('click', performLoginAndDownload);
        document.getElementById('login-senha').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performLoginAndDownload();
        });

        document.querySelectorAll('[data-require-auth="true"]').forEach((el) => {
            el.addEventListener('click', (e) => {
                e.preventDefault();
                const token = localStorage.getItem('token');
                const file = el.getAttribute('data-pdf-file');
                if (!token) {
                    pendingDownloadFile = file;
                    openLoginModal();
                    return;
                }
                if (file) {
                    const url = `${API_BASE}/api/download/pdf?file=${encodeURIComponent(file)}&token=${encodeURIComponent(token)}`;
                    window.open(url, '_blank');
                }
            });
        });
    </script>
</body>

</html>